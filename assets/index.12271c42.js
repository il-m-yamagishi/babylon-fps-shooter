import{E as e,S as t,C as a,a as s,b as n,V as o,F as i,D as r,B as c,c as l,d as h,T as d,G as m,e as u,f as p,g as w}from"./vendor.26c33242.js";class b{constructor(e){this.dashSpeed=.8,this.walkSpeed=.5,this.camera=e}attachControl(e){e=w.BackCompatCameraNoPreventDefault(arguments),this._onKeyboardObservable=this.camera.getScene().onKeyboardObservable.add((t=>{1===t.type&&"ShiftLeft"===t.event.code?this.camera.speed=this.dashSpeed:this.camera.speed=this.walkSpeed,e||t.event.preventDefault()}))}detachControl(e){this._onKeyboardObservable&&(this.camera.getScene().onActiveCameraChanged.remove(this._onKeyboardObservable),this._onKeyboardObservable=null)}getClassName(){return"ShooterCameraDashInput"}getSimpleName(){return"dash"}}const g=document.querySelector("#app");new class{constructor(u,p=!0,w={},g=!0,C={}){this.onMouseClick=()=>{this.engine.isPointerLock||this.engine.enterPointerlock()},this.onResise=()=>{this.engine.resize()},this.engine=new e(u,p,w,g),this.scene=new t(this.engine,C),this.scene.ambientColor=new a(.2,.2,.2),this.camera=function(e,t){const a=new o(200*Math.random()-100,2,200*Math.random()-100),s=new i("MainCamera",a,t);return s.setTarget(o.Zero()),s.inputs.add(new b(s)),s.attachControl(e,!0),s.keysUp=["W".charCodeAt(0)],s.keysDown=["S".charCodeAt(0)],s.keysLeft=["A".charCodeAt(0)],s.keysRight=["D".charCodeAt(0)],s.applyGravity=!0,s.ellipsoid=new o(1.2,1.2,1.2),s.checkCollisions=!0,s.speed=.5,s}(u,this.scene),this.mainLight=function(e){const t=new r("MainLight",new o(200,-700,400),e);return t.intensity=.7,t}(this.scene),this.shadowGenerator=new s(2048,this.mainLight),new n("ssaoPipeline",this.scene,.75,[this.camera]),function(e){const t=c.CreateBox("MainSkyBox",{size:400},e),s=new l("MainSkyBoxMaterial",e);s.backFaceCulling=!1,s.reflectionTexture=new h("https://playground.babylonjs.com/textures/skybox",e),s.reflectionTexture.coordinatesMode=d.SKYBOX_MODE,s.diffuseColor=a.Black(),s.specularColor=a.Black(),t.material=s}(this.scene),function(e){const t=new l("ground",e);t.specularColor=a.Black();const s=new d("https://playground.babylonjs.com/textures/grass.png",e);s.uScale=60,s.vScale=60,t.diffuseTexture=s;const n=new d("https://playground.babylonjs.com/textures/grassn.png",e);n.uScale=60,n.vScale=60,t.bumpTexture=n;const o=m.CreateGround("MainGround",{width:200,height:200},e);o.material=t,o.checkCollisions=!0,o.receiveShadows=!0}(this.scene),function(e){const t=new l("wall",e),a=new d("https://playground.babylonjs.com/textures/floor.png",e);a.uScale=60,a.vScale=5,t.diffuseTexture=a;const s=new d("https://playground.babylonjs.com/textures/normalmap.jpg",e);s.uScale=60,s.vScale=5,t.bumpTexture=s;const n=new l("wall",e),i=new d("https://playground.babylonjs.com/textures/floor.png",e);i.uScale=5,i.vScale=60,n.diffuseTexture=i;const r=new d("https://playground.babylonjs.com/textures/normalmap.jpg",e);r.uScale=5,r.vScale=60,n.bumpTexture=r;let h=c.CreateBox("+z",{size:1},e);h.material=t.clone("mat+z"),h.scaling=new o(200,10,1),h.position.z=100,h.checkCollisions=!0,h.receiveShadows=!0,h=c.CreateBox("-z",{size:1},e),h.material=t.clone("mat-z"),h.scaling=new o(200,10,1),h.position.z=-100,h.checkCollisions=!0,h.receiveShadows=!0,h=c.CreateBox("+x",{size:1},e),h.material=n.clone("mat+x"),h.scaling=new o(1,10,200),h.position.x=100,h.checkCollisions=!0,h.receiveShadows=!0,h=c.CreateBox("-x",{size:1},e),h.material=n.clone("mat-x"),h.scaling=new o(1,10,200),h.position.x=-100,h.checkCollisions=!0,h.receiveShadows=!0}(this.scene),function(e){const t=c.CreateBox("MovingBox",{size:5},e);t.position.y=-2.3,t.checkCollisions=!0,t.receiveShadows=!0,e.onBeforeRenderObservable.add((()=>{const a=e.getEngine().getDeltaTime();t.position.x+=a/60,t.position.x>100&&(t.position.x=-100)}))}(this.scene)}async start(){await async function(e){const t=(await u.ImportMeshAsync("semi_house","https://assets.babylonjs.com/meshes/","both_houses_scene.babylon")).meshes[0];t.checkCollisions=!0;for(let a=0;a<100;a++){const s=t.clone(`house${a}`,null);e.addShadowCaster(s),s.position=new o(200*Math.random()-100,0,200*Math.random()-100),s.scaling=new o(Math.random()+5,Math.random()+5,Math.random()+5),s.rotate(o.Up(),Math.random()*Math.PI*4)}t.isVisible=!1}(this.shadowGenerator),await async function(e,t){const s=p.CreateCapsule("mobBase",{height:4,capSubdivisions:6,radius:1,subdivisions:4,tessellation:16},e);s.position.y=1;const n=new l("MobMaterialBase",e);n.ambientColor=new a(.2,.2,.2),s.material=n;for(let i=0;i<100;i++){const r=s.clone(`Mob${i}`,null);r.material=n.clone(`MobMaterial${i}`),r.material.diffuseColor=new a(Math.random(),Math.random(),Math.random()),t.addShadowCaster(r),r.position=new o(200*Math.random()-100,1,200*Math.random()-100),r.rotate(o.Up(),Math.random()*Math.PI*4),e.onBeforeRenderObservable.add((()=>{r.rotate(o.Up(),.5*Math.random()-.25);const t=e.getEngine().getDeltaTime()/100;r.moveWithCollisions(r.forward.multiplyByFloats(t,t,t))}))}s.isVisible=!1}(this.scene,this.shadowGenerator),window.addEventListener("resize",this.onResise),this.scene.activeCamera=this.camera,document.addEventListener("click",this.onMouseClick),this.engine.runRenderLoop((()=>{this.scene.render()}))}}(g).start().catch((e=>console.error(e)));
